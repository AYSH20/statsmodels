summary(pooled)
# }
setwd("C:/Users/Frank/Documents/GitHub/statsmodels/statsmodels/sandbox/mice/tests")
write.csv(cbind(pooled$u[1:20], pooled$u[81:100], pooled$u[161:180]), "cov.csv", row.names=FALSE)
write.csv(pooled$qhat, "params.csv", row.names=FALSE)
write.csv(data, "missingdata.csv", row.names=FALSE)
plot(rmvnorm(n=100, mean=c(1,1)))
require(mvtnorm)
plot(rmvnorm(n=100, mean=c(1,1)))
plot(rmvnorm(n=100, mean=c(1,1)))
plot(rmvnorm(n=100, mean=c(1,1)))
plot(rmvnorm(n=100, mean=c(1,1)))
plot(rmvnorm(n=100, mean=c(1,1)))
plot(rmvnorm(n=100, mean=c(1,1)))
plot(rmvnorm(n=100, mean=c(1,1)))
plot(rmvnorm(n=100, mean=c(1,1)))
plot(rmvnorm(n=100, mean=c(1,1)), sigma=diag(2))
plot(rmvnorm(n=100, mean=c(1,1), sigma=diag(2)))
plot(rmvnorm(n=100, mean=c(1,1), sigma=diag(2)))
plot(rmvnorm(n=100, mean=c(1,1), sigma=diag(2)))
plot(rmvnorm(n=100, mean=c(1,1), sigma=diag(2)*80))
plot(rmvnorm(n=100, mean=c(1,1), sigma=diag(2)*80))
plot(rmvnorm(n=100, mean=c(1,1), sigma=diag(2)*80))
plot(rmvnorm(n=100, mean=c(1,1), sigma=diag(2)*80))
plot(rmvnorm(n=100, mean=c(1,1), sigma=diag(2)*80))
plot(rmvnorm(n=100, mean=c(1,1), sigma=diag(2)))
size = 300
mu = rep(0,4)
sig = matrix(.8, nrow=4, ncol=4) + diag(4) * .2
normdraws = rmvnorm(n=size, mean=mu, sigma=sigma)
unidraws = pnorm(normdraws)
plot(unidraws)
size = 300
mu = rep(0,4)
sig = matrix(.8, nrow=4, ncol=4) + diag(4) * .2
normdraws = rmvnorm(n=size, mean=mu, sigma=sig)
unidraws = pnorm(normdraws)
plot(unidraws)
size = 300
mu = rep(0,4)
sig = matrix(.8, nrow=4, ncol=4) + diag(4) * .2
normdraws = rmvnorm(n=size, mean=mu, sigma=sig)
unidraws = pnorm(normdraws)
plot(unidraws[,1],unidraws[,3])
size = 300
mu = rep(0,4)
sig = matrix(.8, nrow=4, ncol=4) + diag(4) * .2
normdraws = rmvnorm(n=size, mean=mu, sigma=sig)
unidraws = pnorm(normdraws)
plot(unidraws[,1],unidraws[,4])
size = 300
mu = rep(0,3)
sig = matrix(.8, nrow=3, ncol=3) + diag(3) * .2
draws = rmvnorm(n=size, mean=mu, sigma=sig)
unidraws = pnorm(normdraws)
normdraws = draws[,1]
berndraws = qbinom(unidraws[,2])
poisdraws = qpois(unidraws[,3])
plot(berndraws,poisdraws)
size = 300
mu = rep(0,3)
sig = matrix(.8, nrow=3, ncol=3) + diag(3) * .2
draws = rmvnorm(n=size, mean=mu, sigma=sig)
unidraws = pnorm(normdraws)
normdraws = draws[,1]
berndraws = qbinom(unidraws[,2], 5)
poisdraws = qpois(unidraws[,3], 5)
plot(berndraws,poisdraws)
qpois(unidraws,3)
size = 300
mu = rep(0,3)
sig = matrix(.8, nrow=3, ncol=3) + diag(3) * .2
draws = rmvnorm(n=size, mean=mu, sigma=sig)
unidraws = pnorm(normdraws)
normdraws = draws[,1]
berndraws = qbinom(1-unidraws[,2], 1, 0.75)
poisdraws = qpois(unidraws[,3], 1)
plot(berndraws,poisdraws)
unidraws
draws
unidraws
unidraws[,1]
size = 300
mu = rep(0,3)
sig = matrix(.8, nrow=3, ncol=3) + diag(3) * .2
draws = rmvnorm(n=size, mean=mu, sigma=sig)
unidraws = pnorm(draws)
normdraws = draws[,1]
berndraws = qbinom(1-unidraws[,2], 1, 0.75)
poisdraws = qpois(unidraws[,3], 1)
plot(berndraws,poisdraws)
berndraws
poisdraws
size = 300
mu = rep(0,3)
sig = matrix(.8, nrow=3, ncol=3) + diag(3) * .2
draws = rmvnorm(n=size, mean=mu, sigma=sig)
unidraws = pnorm(draws)
normdraws = draws[,1]
berndraws = qbinom(1-unidraws[,2], 1, 0.75)
poisdraws = qpois(unidraws[,3], 3)
plot(berndraws,poisdraws)
size = 300
mu = rep(0,3)
sig = matrix(.8, nrow=3, ncol=3) + diag(3) * .2
draws = rmvnorm(n=size, mean=mu, sigma=sig)
unidraws = pnorm(draws)
normdraws = draws[,1]
berndraws = qbinom(1-unidraws[,2], 1, 0.75)
poisdraws = qpois(unidraws[,3], 5)
plot(berndraws,poisdraws)
setwd("C:/Users/Frank/Documents/GitHub/statsmodels/statsmodels/sandbox/mice/tests")
size = 300
mu = rep(0,3)
sig = matrix(.8, nrow=3, ncol=3) + diag(3) * .2
draws = rmvnorm(n=size, mean=mu, sigma=sig)
unidraws = pnorm(draws)
normdraws = draws[,1]
berndraws = qbinom(1-unidraws[,2], 1, 0.75)
poisdraws = qpois(unidraws[,3], 5)
y<--1+1*berndraws-1*normdraws+1*poisdraws+rnorm(size,0,1)
alpha.1<-exp(16+2*y-normdraws)/(1+exp(16+2*y-normdraws));
alpha.2<-exp(3.5+.7*y)/(1+exp(3.5+.7*y));
alpha.3<-exp(-13-1.2*y-berndraws)/(1+exp(-13-1.2*y-berndraws));
r.berndraws.mar<-rbinom(N,1,prob=alpha.1)
r.normdraws.mar<-rbinom(N,1,prob=alpha.2)
r.poisdraws.mar<-rbinom(N,1,prob=alpha.3)
berndraws.mar<-berndraws*(1-r.berndraws.mar)+r.berndraws.mar*99999  #berndraws.mar=berndraws if not missing, 99999 if missing
normdraws.mar<-normdraws*(1-r.normdraws.mar)+r.normdraws.mar*99999
poisdraws.mar<-poisdraws*(1-r.poisdraws.mar)+r.poisdraws.mar*99999
berndraws.mar[berndraws.mar==99999]=NA                  #change 99999 to NA (R's notation for missing)
normdraws.mar[normdraws.mar==99999]=NA
poisdraws.mar[poisdraws.mar==99999]=NA
write.csv(cbind(berndraws.mar,normdraws.mar,poisdraws.mar), "missingfull.csv", row.names=FALSE)
setwd("C:/Users/Frank/Documents/GitHub/statsmodels/statsmodels/sandbox/mice/tests")
size = 300
mu = rep(0,3)
sig = matrix(.8, nrow=3, ncol=3) + diag(3) * .2
draws = rmvnorm(n=size, mean=mu, sigma=sig)
unidraws = pnorm(draws)
normdraws = draws[,1]
berndraws = qbinom(1-unidraws[,2], 1, 0.75)
poisdraws = qpois(unidraws[,3], 5)
y<--1+1*berndraws-1*normdraws+1*poisdraws+rnorm(size,0,1)
alpha.1<-exp(200+2*y-normdraws)/(1+exp(200+2*y-normdraws));
alpha.2<-exp(3.5+.7*y)/(1+exp(3.5+.7*y));
alpha.3<-exp(-13-1.2*y-berndraws)/(1+exp(-13-1.2*y-berndraws));
r.berndraws.mar<-rbinom(N,1,prob=alpha.1)
r.normdraws.mar<-rbinom(N,1,prob=alpha.2)
r.poisdraws.mar<-rbinom(N,1,prob=alpha.3)
berndraws.mar<-berndraws*(1-r.berndraws.mar)+r.berndraws.mar*99999  #berndraws.mar=berndraws if not missing, 99999 if missing
normdraws.mar<-normdraws*(1-r.normdraws.mar)+r.normdraws.mar*99999
poisdraws.mar<-poisdraws*(1-r.poisdraws.mar)+r.poisdraws.mar*99999
berndraws.mar[berndraws.mar==99999]=NA                  #change 99999 to NA (R's notation for missing)
normdraws.mar[normdraws.mar==99999]=NA
poisdraws.mar[poisdraws.mar==99999]=NA
write.csv(cbind(berndraws.mar,normdraws.mar,poisdraws.mar), "missingfull.csv", row.names=FALSE)
cbind(berndraws.mar,normdraws.mar,poisdraws.mar)
setwd("C:/Users/Frank/Documents/GitHub/statsmodels/statsmodels/sandbox/mice/tests")
size = 300
mu = rep(0,3)
sig = matrix(.8, nrow=3, ncol=3) + diag(3) * .2
draws = rmvnorm(n=size, mean=mu, sigma=sig)
unidraws = pnorm(draws)
normdraws = draws[,1]
berndraws = qbinom(1-unidraws[,2], 1, 0.75)
poisdraws = qpois(unidraws[,3], 5)
y<--1+1*berndraws-1*normdraws+1*poisdraws+rnorm(size,0,1)
alpha.1<-exp(-200+2*y-normdraws)/(1+exp(-200+2*y-normdraws));
alpha.2<-exp(3.5+.7*y)/(1+exp(3.5+.7*y));
alpha.3<-exp(-13-1.2*y-berndraws)/(1+exp(-13-1.2*y-berndraws));
r.berndraws.mar<-rbinom(N,1,prob=alpha.1)
r.normdraws.mar<-rbinom(N,1,prob=alpha.2)
r.poisdraws.mar<-rbinom(N,1,prob=alpha.3)
berndraws.mar<-berndraws*(1-r.berndraws.mar)+r.berndraws.mar*99999  #berndraws.mar=berndraws if not missing, 99999 if missing
normdraws.mar<-normdraws*(1-r.normdraws.mar)+r.normdraws.mar*99999
poisdraws.mar<-poisdraws*(1-r.poisdraws.mar)+r.poisdraws.mar*99999
berndraws.mar[berndraws.mar==99999]=NA                  #change 99999 to NA (R's notation for missing)
normdraws.mar[normdraws.mar==99999]=NA
poisdraws.mar[poisdraws.mar==99999]=NA
write.csv(cbind(berndraws.mar,normdraws.mar,poisdraws.mar), "missingfull.csv", row.names=FALSE)
cbind(berndraws.mar,normdraws.mar,poisdraws.mar)
setwd("C:/Users/Frank/Documents/GitHub/statsmodels/statsmodels/sandbox/mice/tests")
size = 300
mu = rep(0,3)
sig = matrix(.8, nrow=3, ncol=3) + diag(3) * .2
draws = rmvnorm(n=size, mean=mu, sigma=sig)
unidraws = pnorm(draws)
normdraws = draws[,1]
berndraws = qbinom(1-unidraws[,2], 1, 0.75)
poisdraws = qpois(unidraws[,3], 5)
y<--1+1*berndraws-1*normdraws+1*poisdraws+rnorm(size,0,1)
alpha.1<-exp(-16+2*y-normdraws)/(1+exp(-16+2*y-normdraws));
alpha.2<-exp(-3.5+.7*y)/(1+exp(-3.5+.7*y));
alpha.3<-exp(-13-1.2*y-berndraws)/(1+exp(-13-1.2*y-berndraws));
r.berndraws.mar<-rbinom(N,1,prob=alpha.1)
r.normdraws.mar<-rbinom(N,1,prob=alpha.2)
r.poisdraws.mar<-rbinom(N,1,prob=alpha.3)
berndraws.mar<-berndraws*(1-r.berndraws.mar)+r.berndraws.mar*99999  #berndraws.mar=berndraws if not missing, 99999 if missing
normdraws.mar<-normdraws*(1-r.normdraws.mar)+r.normdraws.mar*99999
poisdraws.mar<-poisdraws*(1-r.poisdraws.mar)+r.poisdraws.mar*99999
berndraws.mar[berndraws.mar==99999]=NA                  #change 99999 to NA (R's notation for missing)
normdraws.mar[normdraws.mar==99999]=NA
poisdraws.mar[poisdraws.mar==99999]=NA
write.csv(cbind(berndraws.mar,normdraws.mar,poisdraws.mar), "missingfull.csv", row.names=FALSE)
cbind(berndraws.mar,normdraws.mar,poisdraws.mar)
setwd("C:/Users/Frank/Documents/GitHub/statsmodels/statsmodels/sandbox/mice/tests")
size = 300
mu = rep(0,3)
sig = matrix(.8, nrow=3, ncol=3) + diag(3) * .2
draws = rmvnorm(n=size, mean=mu, sigma=sig)
unidraws = pnorm(draws)
normdraws = draws[,1]
berndraws = qbinom(1-unidraws[,2], 1, 0.75)
poisdraws = qpois(unidraws[,3], 5)
y<--1+1*berndraws-1*normdraws+1*poisdraws+rnorm(size,0,1)
alpha.1<-exp(-16+2*y-normdraws)/(1+exp(-16+2*y-normdraws));
alpha.2<-exp(-3.5+.7*y)/(1+exp(-3.5+.7*y));
alpha.3<-exp(1.2*y-berndraws)/(1+exp(1.2*y-berndraws));
r.berndraws.mar<-rbinom(N,1,prob=alpha.1)
r.normdraws.mar<-rbinom(N,1,prob=alpha.2)
r.poisdraws.mar<-rbinom(N,1,prob=alpha.3)
berndraws.mar<-berndraws*(1-r.berndraws.mar)+r.berndraws.mar*99999  #berndraws.mar=berndraws if not missing, 99999 if missing
normdraws.mar<-normdraws*(1-r.normdraws.mar)+r.normdraws.mar*99999
poisdraws.mar<-poisdraws*(1-r.poisdraws.mar)+r.poisdraws.mar*99999
berndraws.mar[berndraws.mar==99999]=NA                  #change 99999 to NA (R's notation for missing)
normdraws.mar[normdraws.mar==99999]=NA
poisdraws.mar[poisdraws.mar==99999]=NA
write.csv(cbind(berndraws.mar,normdraws.mar,poisdraws.mar), "missingfull.csv", row.names=FALSE)
cbind(berndraws.mar,normdraws.mar,poisdraws.mar)
setwd("C:/Users/Frank/Documents/GitHub/statsmodels/statsmodels/sandbox/mice/tests")
size = 300
mu = rep(0,3)
sig = matrix(.8, nrow=3, ncol=3) + diag(3) * .2
draws = rmvnorm(n=size, mean=mu, sigma=sig)
unidraws = pnorm(draws)
normdraws = draws[,1]
berndraws = qbinom(1-unidraws[,2], 1, 0.75)
poisdraws = qpois(unidraws[,3], 5)
y<--1+1*berndraws-1*normdraws+1*poisdraws+rnorm(size,0,1)
alpha.1<-exp(-16+2*y-normdraws)/(1+exp(-16+2*y-normdraws));
alpha.2<-exp(-3.5+.7*y)/(1+exp(-3.5+.7*y));
alpha.3<-exp(-1+1.2*y-berndraws)/(1+exp(-1+1.2*y-berndraws));
r.berndraws.mar<-rbinom(N,1,prob=alpha.1)
r.normdraws.mar<-rbinom(N,1,prob=alpha.2)
r.poisdraws.mar<-rbinom(N,1,prob=alpha.3)
berndraws.mar<-berndraws*(1-r.berndraws.mar)+r.berndraws.mar*99999  #berndraws.mar=berndraws if not missing, 99999 if missing
normdraws.mar<-normdraws*(1-r.normdraws.mar)+r.normdraws.mar*99999
poisdraws.mar<-poisdraws*(1-r.poisdraws.mar)+r.poisdraws.mar*99999
berndraws.mar[berndraws.mar==99999]=NA                  #change 99999 to NA (R's notation for missing)
normdraws.mar[normdraws.mar==99999]=NA
poisdraws.mar[poisdraws.mar==99999]=NA
write.csv(cbind(berndraws.mar,normdraws.mar,poisdraws.mar), "missingfull.csv", row.names=FALSE)
cbind(berndraws.mar,normdraws.mar,poisdraws.mar)
setwd("C:/Users/Frank/Documents/GitHub/statsmodels/statsmodels/sandbox/mice/tests")
size = 300
mu = rep(0,3)
sig = matrix(.8, nrow=3, ncol=3) + diag(3) * .2
draws = rmvnorm(n=size, mean=mu, sigma=sig)
unidraws = pnorm(draws)
normdraws = draws[,1]
berndraws = qbinom(1-unidraws[,2], 1, 0.75)
poisdraws = qpois(unidraws[,3], 5)
y<--1+1*berndraws-1*normdraws+1*poisdraws+rnorm(size,0,1)
alpha.1<-exp(-16+2*y-normdraws)/(1+exp(-16+2*y-normdraws));
alpha.2<-exp(-3.5+.7*y)/(1+exp(-3.5+.7*y));
alpha.3<-exp(-2+1.2*y-berndraws)/(1+exp(-2+1.2*y-berndraws));
r.berndraws.mar<-rbinom(N,1,prob=alpha.1)
r.normdraws.mar<-rbinom(N,1,prob=alpha.2)
r.poisdraws.mar<-rbinom(N,1,prob=alpha.3)
berndraws.mar<-berndraws*(1-r.berndraws.mar)+r.berndraws.mar*99999  #berndraws.mar=berndraws if not missing, 99999 if missing
normdraws.mar<-normdraws*(1-r.normdraws.mar)+r.normdraws.mar*99999
poisdraws.mar<-poisdraws*(1-r.poisdraws.mar)+r.poisdraws.mar*99999
berndraws.mar[berndraws.mar==99999]=NA                  #change 99999 to NA (R's notation for missing)
normdraws.mar[normdraws.mar==99999]=NA
poisdraws.mar[poisdraws.mar==99999]=NA
write.csv(cbind(berndraws.mar,normdraws.mar,poisdraws.mar), "missingfull.csv", row.names=FALSE)
cbind(berndraws.mar,normdraws.mar,poisdraws.mar)
setwd("C:/Users/Frank/Documents/GitHub/statsmodels/statsmodels/sandbox/mice/tests")
size = 300
mu = rep(0,3)
sig = matrix(.8, nrow=3, ncol=3) + diag(3) * .2
draws = rmvnorm(n=size, mean=mu, sigma=sig)
unidraws = pnorm(draws)
normdraws = draws[,1]
berndraws = qbinom(1-unidraws[,2], 1, 0.75)
poisdraws = qpois(unidraws[,3], 5)
y<--1+1*berndraws-1*normdraws+1*poisdraws+rnorm(size,0,1)
alpha.1<-exp(-16+2*y-normdraws)/(1+exp(-16+2*y-normdraws));
alpha.2<-exp(-3.5+.7*y)/(1+exp(-3.5+.7*y));
alpha.3<-exp(-3+1.2*y-berndraws)/(1+exp(-3+1.2*y-berndraws));
r.berndraws.mar<-rbinom(N,1,prob=alpha.1)
r.normdraws.mar<-rbinom(N,1,prob=alpha.2)
r.poisdraws.mar<-rbinom(N,1,prob=alpha.3)
berndraws.mar<-berndraws*(1-r.berndraws.mar)+r.berndraws.mar*99999  #berndraws.mar=berndraws if not missing, 99999 if missing
normdraws.mar<-normdraws*(1-r.normdraws.mar)+r.normdraws.mar*99999
poisdraws.mar<-poisdraws*(1-r.poisdraws.mar)+r.poisdraws.mar*99999
berndraws.mar[berndraws.mar==99999]=NA                  #change 99999 to NA (R's notation for missing)
normdraws.mar[normdraws.mar==99999]=NA
poisdraws.mar[poisdraws.mar==99999]=NA
write.csv(cbind(berndraws.mar,normdraws.mar,poisdraws.mar), "missingfull.csv", row.names=FALSE)
cbind(berndraws.mar,normdraws.mar,poisdraws.mar)
setwd("C:/Users/Frank/Documents/GitHub/statsmodels/statsmodels/sandbox/mice/tests")
size = 300
mu = rep(0,3)
sig = matrix(.8, nrow=3, ncol=3) + diag(3) * .2
draws = rmvnorm(n=size, mean=mu, sigma=sig)
unidraws = pnorm(draws)
normdraws = draws[,1]
berndraws = qbinom(1-unidraws[,2], 1, 0.75)
poisdraws = qpois(unidraws[,3], 5)
y<--1+1*berndraws-1*normdraws+1*poisdraws+rnorm(size,0,1)
alpha.1<-exp(-16+2*y-normdraws)/(1+exp(-16+2*y-normdraws));
alpha.2<-exp(-3.5+.7*y)/(1+exp(-3.5+.7*y));
alpha.3<-exp(-4+1.2*y-berndraws)/(1+exp(-4+1.2*y-berndraws));
r.berndraws.mar<-rbinom(N,1,prob=alpha.1)
r.normdraws.mar<-rbinom(N,1,prob=alpha.2)
r.poisdraws.mar<-rbinom(N,1,prob=alpha.3)
berndraws.mar<-berndraws*(1-r.berndraws.mar)+r.berndraws.mar*99999  #berndraws.mar=berndraws if not missing, 99999 if missing
normdraws.mar<-normdraws*(1-r.normdraws.mar)+r.normdraws.mar*99999
poisdraws.mar<-poisdraws*(1-r.poisdraws.mar)+r.poisdraws.mar*99999
berndraws.mar[berndraws.mar==99999]=NA                  #change 99999 to NA (R's notation for missing)
normdraws.mar[normdraws.mar==99999]=NA
poisdraws.mar[poisdraws.mar==99999]=NA
write.csv(cbind(berndraws.mar,normdraws.mar,poisdraws.mar), "missingfull.csv", row.names=FALSE)
cbind(berndraws.mar,normdraws.mar,poisdraws.mar)
setwd("C:/Users/Frank/Documents/GitHub/statsmodels/statsmodels/sandbox/mice/tests")
size = 300
mu = rep(0,3)
sig = matrix(.8, nrow=3, ncol=3) + diag(3) * .2
draws = rmvnorm(n=size, mean=mu, sigma=sig)
unidraws = pnorm(draws)
normdraws = draws[,1]
berndraws = qbinom(1-unidraws[,2], 1, 0.75)
poisdraws = qpois(unidraws[,3], 5)
y<--1+1*berndraws-1*normdraws+1*poisdraws+rnorm(size,0,1)
alpha.1<-exp(-16+2*y-normdraws)/(1+exp(-16+2*y-normdraws));
alpha.2<-exp(-3.5+.7*y)/(1+exp(-3.5+.7*y));
alpha.3<-exp(-6+1.2*y-berndraws)/(1+exp(-6+1.2*y-berndraws));
r.berndraws.mar<-rbinom(N,1,prob=alpha.1)
r.normdraws.mar<-rbinom(N,1,prob=alpha.2)
r.poisdraws.mar<-rbinom(N,1,prob=alpha.3)
berndraws.mar<-berndraws*(1-r.berndraws.mar)+r.berndraws.mar*99999  #berndraws.mar=berndraws if not missing, 99999 if missing
normdraws.mar<-normdraws*(1-r.normdraws.mar)+r.normdraws.mar*99999
poisdraws.mar<-poisdraws*(1-r.poisdraws.mar)+r.poisdraws.mar*99999
berndraws.mar[berndraws.mar==99999]=NA                  #change 99999 to NA (R's notation for missing)
normdraws.mar[normdraws.mar==99999]=NA
poisdraws.mar[poisdraws.mar==99999]=NA
write.csv(cbind(berndraws.mar,normdraws.mar,poisdraws.mar), "missingfull.csv", row.names=FALSE)
cbind(berndraws.mar,normdraws.mar,poisdraws.mar)
setwd("C:/Users/Frank/Documents/GitHub/statsmodels/statsmodels/sandbox/examples")
size = 300
mu = rep(0,3)
sig = matrix(.8, nrow=3, ncol=3) + diag(3) * .2
draws = rmvnorm(n=size, mean=mu, sigma=sig)
unidraws = pnorm(draws)
normdraws = draws[,1]
berndraws = qbinom(1-unidraws[,2], 1, 0.75)
poisdraws = qpois(unidraws[,3], 5)
y<--1+1*berndraws-1*normdraws+1*poisdraws+rnorm(size,0,1)
alpha.1<-exp(-16+2*y-normdraws)/(1+exp(-16+2*y-normdraws));
alpha.2<-exp(-3.5+.7*y)/(1+exp(-3.5+.7*y));
alpha.3<-exp(-6+1.2*y-berndraws)/(1+exp(-6+1.2*y-berndraws));
r.berndraws.mar<-rbinom(N,1,prob=alpha.1)
r.normdraws.mar<-rbinom(N,1,prob=alpha.2)
r.poisdraws.mar<-rbinom(N,1,prob=alpha.3)
berndraws.mar<-berndraws*(1-r.berndraws.mar)+r.berndraws.mar*99999  #berndraws.mar=berndraws if not missing, 99999 if missing
normdraws.mar<-normdraws*(1-r.normdraws.mar)+r.normdraws.mar*99999
poisdraws.mar<-poisdraws*(1-r.poisdraws.mar)+r.poisdraws.mar*99999
berndraws.mar[berndraws.mar==99999]=NA                  #change 99999 to NA (R's notation for missing)
normdraws.mar[normdraws.mar==99999]=NA
poisdraws.mar[poisdraws.mar==99999]=NA
write.csv(cbind(berndraws.mar,normdraws.mar,poisdraws.mar), "missingfull.csv", row.names=FALSE)
setwd("C:/Users/Frank/Documents/GitHub/statsmodels/statsmodels/sandbox/examples")
require(mice)
data = read.csv("missingfull.csv")
imp = mice(data, m=20, method="pmm", maxit=20)
mod = lm(X1 ~ X2 + X3, data)
pooled = pool(with(imp, mod))
print(summary(pooled))
setwd("C:/Users/Frank/Documents/GitHub/statsmodels/statsmodels/sandbox/examples")
require(mice)
data = read.csv("missingfull.csv")
imp = mice(data, m=20, method="pmm", maxit=20)
mod = lm(berndraws.mar ~ normdraws.mar + poisdraws.mar, data)
pooled = pool(with(imp, mod))
print(summary(pooled))
setwd("C:/Users/Frank/Documents/GitHub/statsmodels/statsmodels/sandbox/examples")
require(mice)
data = read.csv("missingfull.csv")
imp = mice(data, m=20, method="pmm", maxit=20)
mod = glm(berndraws.mar ~ normdraws.mar + poisdraws.mar, data, family=binomial)
pooled = pool(with(imp, mod))
print(summary(pooled))
setwd("C:/Users/Frank/Documents/GitHub/statsmodels/statsmodels/sandbox/examples")
size = 300
mu = rep(0,3)
sig = matrix(.8, nrow=3, ncol=3) + diag(3) * .2
draws = rmvnorm(n=size, mean=mu, sigma=sig)
unidraws = pnorm(draws)
normdraws = draws[,1]
berndraws = qbinom(1-unidraws[,2], 1, 0.75)
poisdraws = qpois(unidraws[,3], 5)
y<--1+1*berndraws-1*normdraws+1*poisdraws+rnorm(size,0,1)
alpha.1<-exp(-16+2*y-normdraws)/(1+exp(-16+2*y-normdraws));
alpha.2<-exp(-3.5+.7*y)/(1+exp(-3.5+.7*y));
alpha.3<-exp(-6+1.2*y-berndraws)/(1+exp(-6+1.2*y-berndraws));
r.berndraws.mar<-rbinom(N,1,prob=alpha.1)
r.normdraws.mar<-rbinom(N,1,prob=alpha.2)
r.poisdraws.mar<-rbinom(N,1,prob=alpha.3)
berndraws.mar<-berndraws*(1-r.berndraws.mar)+r.berndraws.mar*99999  #berndraws.mar=berndraws if not missing, 99999 if missing
normdraws.mar<-normdraws*(1-r.normdraws.mar)+r.normdraws.mar*99999
poisdraws.mar<-poisdraws*(1-r.poisdraws.mar)+r.poisdraws.mar*99999
berndraws.mar[berndraws.mar==99999]=NA                  #change 99999 to NA (R's notation for missing)
normdraws.mar[normdraws.mar==99999]=NA
poisdraws.mar[poisdraws.mar==99999]=NA
write.csv(cbind(berndraws.mar,normdraws.mar,poisdraws.mar), "missingfull.csv", row.names=FALSE)
require(mice)
data = read.csv("missingfull.csv")
imp = mice(data, m=20, method="pmm", maxit=20)
mod = glm(berndraws.mar ~ normdraws.mar + poisdraws.mar, data, family=binomial)
pooled = pool(with(imp, mod))
print(summary(pooled))
setwd("C:/Users/Frank/Documents/GitHub/statsmodels/statsmodels/sandbox/examples")
size = 300
mu = rep(0,3)
sig = matrix(.8, nrow=3, ncol=3) + diag(3) * .2
draws = rmvnorm(n=size, mean=mu, sigma=sig)
unidraws = pnorm(draws)
normdraws = draws[,1]
berndraws = qbinom(1-unidraws[,2], 1, 0.75)
poisdraws = qpois(unidraws[,3], 5)
y<--1+1*berndraws-1*normdraws+1*poisdraws+rnorm(size,0,1)
alpha.1<-exp(-16+2*y-normdraws)/(1+exp(-16+2*y-normdraws));
alpha.2<-exp(-3.5+.7*y)/(1+exp(-3.5+.7*y));
alpha.3<-exp(-6+1.2*y-berndraws)/(1+exp(-6+1.2*y-berndraws));
r.berndraws.mar<-rbinom(N,1,prob=alpha.1)
r.normdraws.mar<-rbinom(N,1,prob=alpha.2)
r.poisdraws.mar<-rbinom(N,1,prob=alpha.3)
berndraws.mar<-berndraws*(1-r.berndraws.mar)+r.berndraws.mar*99999  #berndraws.mar=berndraws if not missing, 99999 if missing
normdraws.mar<-normdraws*(1-r.normdraws.mar)+r.normdraws.mar*99999
poisdraws.mar<-poisdraws*(1-r.poisdraws.mar)+r.poisdraws.mar*99999
berndraws.mar[berndraws.mar==99999]=NA                  #change 99999 to NA (R's notation for missing)
normdraws.mar[normdraws.mar==99999]=NA
poisdraws.mar[poisdraws.mar==99999]=NA
write.csv(cbind(berndraws.mar,normdraws.mar,poisdraws.mar), "missingfull.csv", row.names=FALSE)
require(mice)
data = read.csv("missingfull.csv")
imp = mice(data, m=20, method="pmm", maxit=20)
mod = glm(berndraws.mar ~ normdraws.mar + poisdraws.mar, data, family=binomial)
pooled = pool(with(imp, mod))
print(summary(pooled))
setwd("C:/Users/Frank/Documents/GitHub/statsmodels/statsmodels/sandbox/examples")
size = 300
cor = 0.9
mu = rep(0,3)
sig = matrix(cor, nrow=3, ncol=3) + diag(3) * (1-cor)
draws = rmvnorm(n=size, mean=mu, sigma=sig)
unidraws = pnorm(draws)
normdraws = draws[,1]
berndraws = qbinom(1-unidraws[,2], 1, 0.75)
poisdraws = qpois(unidraws[,3], 5)
y<--1+1*berndraws-1*normdraws+1*poisdraws+rnorm(size,0,1)
alpha.1<-exp(-16+2*y-normdraws)/(1+exp(-16+2*y-normdraws));
alpha.2<-exp(-3.5+.7*y)/(1+exp(-3.5+.7*y));
alpha.3<-exp(-6+1.2*y-berndraws)/(1+exp(-6+1.2*y-berndraws));
r.berndraws.mar<-rbinom(N,1,prob=alpha.1)
r.normdraws.mar<-rbinom(N,1,prob=alpha.2)
r.poisdraws.mar<-rbinom(N,1,prob=alpha.3)
berndraws.mar<-berndraws*(1-r.berndraws.mar)+r.berndraws.mar*99999  #berndraws.mar=berndraws if not missing, 99999 if missing
normdraws.mar<-normdraws*(1-r.normdraws.mar)+r.normdraws.mar*99999
poisdraws.mar<-poisdraws*(1-r.poisdraws.mar)+r.poisdraws.mar*99999
berndraws.mar[berndraws.mar==99999]=NA                  #change 99999 to NA (R's notation for missing)
normdraws.mar[normdraws.mar==99999]=NA
poisdraws.mar[poisdraws.mar==99999]=NA
write.csv(cbind(berndraws.mar,normdraws.mar,poisdraws.mar), "missingfull.csv", row.names=FALSE)
require(mice)
data = read.csv("missingfull.csv")
imp = mice(data, m=20, method="pmm", maxit=20)
mod = glm(berndraws.mar ~ normdraws.mar + poisdraws.mar, data, family=binomial)
pooled = pool(with(imp, mod))
print(summary(pooled))
setwd("C:/Users/Frank/Documents/GitHub/statsmodels/statsmodels/sandbox/examples")
size = 1000
cor = 0.9
mu = rep(0,3)
sig = matrix(cor, nrow=3, ncol=3) + diag(3) * (1-cor)
draws = rmvnorm(n=size, mean=mu, sigma=sig)
unidraws = pnorm(draws)
normdraws = draws[,1]
berndraws = qbinom(1-unidraws[,2], 1, 0.75)
poisdraws = qpois(unidraws[,3], 5)
y<--1+1*berndraws-1*normdraws+1*poisdraws+rnorm(size,0,1)
alpha.1<-exp(-16+2*y-normdraws)/(1+exp(-16+2*y-normdraws));
alpha.2<-exp(-3.5+.7*y)/(1+exp(-3.5+.7*y));
alpha.3<-exp(-6+1.2*y-berndraws)/(1+exp(-6+1.2*y-berndraws));
r.berndraws.mar<-rbinom(N,1,prob=alpha.1)
r.normdraws.mar<-rbinom(N,1,prob=alpha.2)
r.poisdraws.mar<-rbinom(N,1,prob=alpha.3)
berndraws.mar<-berndraws*(1-r.berndraws.mar)+r.berndraws.mar*99999  #berndraws.mar=berndraws if not missing, 99999 if missing
normdraws.mar<-normdraws*(1-r.normdraws.mar)+r.normdraws.mar*99999
poisdraws.mar<-poisdraws*(1-r.poisdraws.mar)+r.poisdraws.mar*99999
berndraws.mar[berndraws.mar==99999]=NA                  #change 99999 to NA (R's notation for missing)
normdraws.mar[normdraws.mar==99999]=NA
poisdraws.mar[poisdraws.mar==99999]=NA
write.csv(cbind(berndraws.mar,normdraws.mar,poisdraws.mar), "missingfull.csv", row.names=FALSE)
require(mice)
data = read.csv("missingfull.csv")
imp = mice(data, m=20, method="pmm", maxit=20)
mod = glm(berndraws.mar ~ normdraws.mar + poisdraws.mar, data, family=binomial)
pooled = pool(with(imp, mod))
print(summary(pooled))
